(this["webpackJsonpf4u-simulator-tools"]=this["webpackJsonpf4u-simulator-tools"]||[]).push([[0],{153:function(e,t,a){e.exports=a(272)},158:function(e,t,a){},272:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(3),c=a.n(o),s=(a(158),a(38)),i=a(39),l=a(54),m=a(52),u=a(275),p=a(56),f=a(23),d=a(274),h=a(276),b=a(33),E=a(20),S=a.n(E),g=a(280),I=a(281),v=a(127),k=a.n(v);var H="dev";switch(function(){var e=window.location.search,t={};return e.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),(function(e,a,n,r){t[a]=r})),t}().env){case"dev":H="dev";break;case"tic":H="tic";break;default:H="dev"}var w="tic"==H?"https://bho5ndseoh.execute-api.ap-southeast-1.amazonaws.com/Tic/api":"https://gya6ha83ql.execute-api.ap-southeast-1.amazonaws.com/Dev/api",R=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"male";Object(s.a)(this,e),this.AVG_NORMAL_HR=60,this.MAX_DIFF_FITNESS_HR=5,this.MIN_FITNESS_HR=65,this.MAX_FITNESS_HR=("male"==t?40:10)+Math.round(120*Math.random())}return Object(i.a)(e,[{key:"RandomNormalHR",value:function(){return this.AVG_NORMAL_HR+Math.round(20*(Math.random()-.5))}},{key:"Equation",value:function(e){return e}},{key:"RandomFitnessHR",value:function(e){var t=e<this.MIN_FITNESS_HR?.3:e>this.MAX_FITNESS_HR?.7:1-this.Equation((this.MAX_FITNESS_HR-e)/(this.MAX_FITNESS_HR-this.MIN_FITNESS_HR));return e+Math.round((Math.random()-t)*(this.MAX_DIFF_FITNESS_HR-t*this.MAX_DIFF_FITNESS_HR/2))}},{key:"IncreaseFitness",value:function(){this.MAX_FITNESS_HR+=30,this.MIN_FITNESS_HR+=30}},{key:"DecreaseFitness",value:function(){this.MAX_FITNESS_HR-=30,this.MIN_FITNESS_HR-=30}}]),e}();function y(e){S.a.post("".concat(w,"/members/").concat(e.MemberId,"/performance"),e).then((function(e){return console.log("SUCCESS",e)})).catch((function(e){return console.log("ERROR",e)}))}function C(e,t,a){return Math.round(t/a*100)}function P(e,t){return e/t*15.3}function M(e,t){return Math.round(e/t*100)}var O=function(e){Object(l.a)(a,e);var t=Object(m.a)(a);function a(e){var n;Object(s.a)(this,a),(n=t.call(this,e)).HR=new R(e.info.memberInfo.gender?"male":"famale");var r=n.HR.RandomNormalHR(),o=C(e.info.memberInfo.gender,r,e.info.memberInfo.maxHr),c=parseFloat(P(r,e.info.memberInfo.restHr).toFixed(3)),i=M(c,e.info.memberInfo.maxVO2);return n.performance={ClassId:n.props.classId,MemberId:n.props.info.memberInfo.id,Hr:r,Calories:0,Zone1:0,Zone2:0,Zone3:0,Zone4:0,Zone5:0,Heavyload:0,PeakHr:r,PercentHr:o,PeakPercentHr:o,VO2:c,PeakVO2:c,PercentVO2:i,PeakPercentVO2:i},n.state={currentHr:n.performance.Hr,emulatorInterval:void 0,isEmulatorRun:!1,isCrease:!1,time:0,status:e.info.status},n.UpdateStatus=function(e){S.a.post("".concat(w,"/classes/").concat(n.props.classId,"/updateMember"),{ClassId:n.props.classId,MemberId:n.props.info.memberInfo.id,isCheckIn:"Checked-in"==e}).then((function(){n.setState({status:e})}))},n.Unbook=function(){S.a.post("".concat(w,"/classes/").concat(n.props.classId,"/removeMember"),{ClassId:n.props.classId,MemberId:n.props.info.memberInfo.id})},n.ResetPerformance=function(){var e;e=n.props.info.memberInfo.id,y({ClassId:n.props.classId,MemberId:e,Hr:0,Calories:0,Zone1:0,Zone2:0,Zone3:0,Zone4:0,Zone5:0,Heavyload:0,PeakHr:0,PercentHr:0,PeakPercentHr:0,VO2:0,PeakVO2:0,PercentVO2:0,PeakPercentVO2:0})},n.RunEmulator=function(){"Checked-in"!==n.state.status||n.state.isEmulatorRun||n.setState({emulatorInterval:setInterval((function(){var e,t=n.props.info.memberInfo.gender?"male":"female",a=n.props.info.memberInfo,r=a.weight,o=a.age,c=a.restHr,s=a.maxHr,i=a.maxVO2;n.performance.Hr=n.HR.RandomFitnessHR(n.performance.Hr),n.performance.PercentHr=C(0,n.performance.Hr,s),n.performance.Calories=parseFloat((n.performance.Calories+function(e,t,a,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1/3600,o=0;return(o="male"==e?(.6309*n-55.0969+.1988*t+.2017*a)/4.184*60*r:(.4472*n-20.4022-.1263*t+.074*a)/4.184*60*r)<0?0:o}(t,r,o,n.performance.Hr)).toFixed(3)),n.performance["Zone"+(e=n.performance.PercentHr,e<=60?1:e<=70?2:e<=80?3:e<=90?4:5)]+=1,n.performance.Heavyload=n.performance.Zone4+n.performance.Zone5,n.performance.PeakHr=n.performance.Hr>n.performance.PeakHr?n.performance.Hr:n.performance.PeakHr,n.performance.PeakPercentHr=n.performance.PercentHr>n.performance.PeakPercentHr?n.performance.PercentHr:n.performance.PeakPercentHr,n.performance.VO2=parseFloat(P(n.performance.Hr,c).toFixed(3)),n.performance.PeakVO2=n.performance.VO2>n.performance.PeakVO2?n.performance.VO2:n.performance.PeakVO2,n.performance.PercentVO2=M(n.performance.VO2,i),n.performance.PeakPercentVO2=n.performance.PercentVO2>n.performance.PeakPercentVO2?n.performance.PercentVO2:n.performance.PeakPercentVO2,y(n.performance),n.setState({currentHr:n.performance.Hr,time:n.state.time+1})}),1e3),isEmulatorRun:!0})},n.StopEmulator=function(){n.state.isEmulatorRun&&(clearInterval(n.state.emulatorInterval),n.setState({emulatorInterval:void 0,isEmulatorRun:!1}))},n.IncreaseFitness=function(){n.HR.IncreaseFitness(),n.setState({isCrease:!0}),setTimeout((function(){n.setState({isCrease:!1})}),3e3)},n.DecreaseFitness=function(){n.HR.DecreaseFitness(),n.setState({isCrease:!0}),setTimeout((function(){n.setState({isCrease:!1})}),3e3)},n.props.startSubcribers.push(n.RunEmulator),n.props.stopSubcribers.push(n.StopEmulator),n.props.joinSubcribers.push((function(){n.UpdateStatus("Checked-in")})),n.props.resetSubcribers.push((function(){n.StopEmulator(),n.ResetPerformance(),n.UpdateStatus("Booked")})),n}return Object(i.a)(a,[{key:"render",value:function(){var e,t=this,a=this.props.info.memberInfo,n=a.id,o=a.fullName,c=a.photoURL,s=a.gender,i=a.weight,l=a.age,m=a.maxHr,E=this.state,v=E.currentHr,H=E.isEmulatorRun,R=E.isCrease,y=E.time,C=E.status,P=this.performance,M=P.Calories,O=P.Zone1,F=P.Zone2,_=P.Zone3,V=P.Zone4,x=P.Zone5,T=P.Heavyload,A=P.PercentHr,N=P.PeakHr,j=P.PeakPercentHr,Z=P.VO2,D=P.PeakVO2;return r.a.createElement(u.a,{bodyStyle:{padding:10}},r.a.createElement(p.a,null,r.a.createElement(f.a,{span:7},r.a.createElement(d.a,{src:c,size:100})),r.a.createElement(f.a,{span:17},r.a.createElement(p.a,null,r.a.createElement(f.a,null,r.a.createElement(h.a.Text,{strong:!0,style:{fontSize:"1.3em"}},"[".concat(n,"]").concat(o)),r.a.createElement("span",null," (".concat(s?"male":"female"," - ").concat(l," ya - ").concat(i," kg) ").concat(k.a.utc(1e3*y).format("HH:mm:ss"))))),r.a.createElement(p.a,{gutter:10},r.a.createElement(f.a,{span:8},"Booked"==C?r.a.createElement(b.a,{type:"primary",style:{backgroundColor:"yellow",width:"100%",color:"red"},onClick:function(){var e,a;(e=n,a=t.props.classId,S.a.post("".concat(w,"/classes/").concat(a,"/updateMember"),{ClassId:a,MemberId:e,isCheckIn:!0})).then((function(e){t.setState({status:"Checked-in"})})).catch((function(e){return console.catch("ERROR",e)}))}},"Join"):H?r.a.createElement(b.a,{type:"primary",danger:!0,style:{width:"100%"},onClick:function(){t.StopEmulator()}},"Stop"):r.a.createElement(b.a,{type:"primary",style:{width:"100%"},onClick:function(){t.RunEmulator()}},"Start")),r.a.createElement(f.a,{span:8},r.a.createElement(b.a,{style:{width:"100%"},icon:r.a.createElement(g.a,null),loading:R,onClick:function(){t.IncreaseFitness()}})),r.a.createElement(f.a,{span:8},r.a.createElement(b.a,{style:{width:"100%"},icon:r.a.createElement(I.a,null),loading:R,onClick:function(){t.DecreaseFitness()}}))),r.a.createElement(p.a,{gutter:10},r.a.createElement(f.a,{span:8},r.a.createElement(h.a.Text,null,"HR: ","".concat(v," / ").concat(N))),r.a.createElement(f.a,{span:8},r.a.createElement(h.a.Text,{style:{color:(e=A,e<=60?"gray":e<=70?"blue":e<=80?"green":e<=90?"orange":"red")}},"%HR: ","".concat(A," / ").concat(j))),r.a.createElement(f.a,{span:8},r.a.createElement(h.a.Text,null,"MaxHr: ",m))),r.a.createElement(p.a,{gutter:10},r.a.createElement(f.a,{span:12},r.a.createElement(h.a.Text,null,"VO2: ","".concat(Z," / ").concat(D)))),r.a.createElement(p.a,{gutter:10},r.a.createElement(f.a,{span:12},r.a.createElement(h.a.Text,null,"Calories: ",M)),r.a.createElement(f.a,{span:12},r.a.createElement(h.a.Text,{strong:!0},"Splat point: ",T))))),r.a.createElement(p.a,{gutter:10,justify:"space-between"},r.a.createElement(f.a,{style:{backgroundColor:"gray",color:"white",fontWeight:"bold",width:"20%",textAlign:"center"}},r.a.createElement(h.a.Text,{style:{color:"white"}},O)),r.a.createElement(f.a,{style:{backgroundColor:"blue",color:"white",fontWeight:"bold",width:"20%",textAlign:"center"}},r.a.createElement(h.a.Text,{style:{color:"white"}},F)),r.a.createElement(f.a,{style:{backgroundColor:"green",color:"white",fontWeight:"bold",width:"20%",textAlign:"center"}},r.a.createElement(h.a.Text,{style:{color:"white"}},_)),r.a.createElement(f.a,{style:{backgroundColor:"orange",color:"white",fontWeight:"bold",width:"20%",textAlign:"center"}},r.a.createElement(h.a.Text,{style:{color:"white"}},V)),r.a.createElement(f.a,{style:{backgroundColor:"red",fontWeight:"bold",width:"20%",textAlign:"center"}},r.a.createElement(h.a.Text,{style:{color:"white"}},x))))}},{key:"componentDidMount",value:function(){}}]),a}(r.a.Component);var F=function(e){Object(l.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={roster:[]},n}return Object(i.a)(a,[{key:"render",value:function(){var e=this,t=this.props.roster;return r.a.createElement("div",{style:{width:"100%"}},r.a.createElement(p.a,{gutter:[10,10],style:{padding:10}},0===(t||[]).length?"No members":t.map((function(t){return r.a.createElement(f.a,{key:t.id,span:8,md:12},r.a.createElement(O,{classId:e.props.classId,info:t,startSubcribers:e.props.startSubcribers,stopSubcribers:e.props.stopSubcribers,joinSubcribers:e.props.joinSubcribers,resetSubcribers:e.props.resetSubcribers}))}))))}},{key:"componentDidMount",value:function(){}}]),a}(r.a.Component),_=a(278),V=a(279),x=a(277);function T(){var e=window.location.search,t={};return e.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),(function(e,a,n,r){t[a]=r})),t}var A=function(e){Object(l.a)(a,e);var t=Object(m.a)(a);function a(e){var n;Object(s.a)(this,a),(n=t.call(this,e)).startSubcribers=[],n.stopSubcribers=[],n.joinSubcribers=[],n.resetSubcribers=[],n.Renew=function(e){window.location.reload()};var r=T();return n.classId=parseInt(r.classId)||1,n.state={isRenewwing:!1,isStarting:!1,isStopping:!1,classId:1,modalVisible:!1,isFetchingMembers:!0,members:[],selectedMember:void 0,rosters:[]},n.StartAll=function(){n.startSubcribers.forEach((function(e){return e()}))},n.StopAll=function(){n.stopSubcribers.forEach((function(e){return e()}))},n.JoinAll=function(){n.joinSubcribers.forEach((function(e){return e()}))},n.Reset=function(){n.setState({isRenewwing:!0}),n.resetSubcribers.forEach((function(e){return e()})),setTimeout((function(){window.location.reload()}),3e3)},n.showModal=function(){var e;n.setState({modalVisible:!0,isFetchingMembers:!0,members:[],selectedMember:void 0}),(e=n.classId,S.a.get("".concat(w,"/members")).then((function(t){var a=t.data.members;return S.a.get("".concat(w,"/classes/").concat(e,"/roster")).then((function(e){var t=e.data.rosters?e.data.rosters.map((function(e){return e.memberInfo.id})):[];return Promise.resolve(a.filter((function(e){return!t.includes(e.id)})))})).catch((function(e){return Promise.reject(e)}))})).catch((function(e){return Promise.reject(e)}))).then((function(e){n.setState({members:e,isFetchingMembers:!1})}))},n.handleOk=function(e){var t,a;console.log(e),n.setState({modalVisible:!1}),n.state.selectedMember&&(t=n.classId,a=n.state.selectedMember,S.a.post("".concat(w,"/classes/").concat(t,"/addMember"),{memberId:a,classId:t})).then((function(e){n.fetchRoster(n.classId)}))},n.handleCancel=function(e){console.log(e),n.setState({modalVisible:!1})},n.fetchRoster=function(e){S.a.get("".concat(w,"/classes/").concat(e,"/roster")).then((function(e){n.setState({rosters:e.data.rosters})}))},n.selectEnv=function(e){window.location.href="/f4u-simulator-tools?env="+e},n}return Object(i.a)(a,[{key:"render",value:function(){var e=this,t=T(),a=parseInt(t.classId)||1;return r.a.createElement("div",null,r.a.createElement(p.a,null,r.a.createElement(f.a,null,r.a.createElement("span",{style:{fontWeight:"bold",fontSize:16}},"Evironment "),r.a.createElement(_.a,{style:{width:100},value:H,onChange:this.selectEnv},r.a.createElement(_.a.Option,{value:"dev"},"DEV"),r.a.createElement(_.a.Option,{value:"tic"},"TIC")))),r.a.createElement(p.a,{gutter:10},r.a.createElement(f.a,null,r.a.createElement(b.a,{loading:this.state.isRenewwing,type:"primary",onClick:function(){e.Reset()}},"Reset")),r.a.createElement(f.a,null,r.a.createElement(b.a,{loading:this.state.isRenewwing,type:"primary",onClick:function(){e.JoinAll()}},"Join All")),r.a.createElement(f.a,null,r.a.createElement(b.a,{loading:this.state.isRenewwing,type:"primary",onClick:function(){e.StartAll()}},"Start All")),r.a.createElement(f.a,null,r.a.createElement(b.a,{loading:this.state.isRenewwing,type:"primary",onClick:function(){e.StopAll()}},"Stop All")),r.a.createElement(f.a,null,r.a.createElement(V.a.Search,{placeholder:"class id",onSearch:function(e){window.location.href="/f4u-simulator-tools?env=".concat(H,"&classId=").concat(e)},style:{width:200}}),r.a.createElement("span",null,"Current class id = ".concat(a))),r.a.createElement(f.a,null,r.a.createElement(b.a,{type:"primary",onClick:this.showModal},"Book member"))),r.a.createElement(p.a,null,r.a.createElement(f.a,{span:24},r.a.createElement(F,{roster:this.state.rosters,classId:a,startSubcribers:this.startSubcribers,stopSubcribers:this.stopSubcribers,joinSubcribers:this.joinSubcribers,resetSubcribers:this.resetSubcribers}))),r.a.createElement(x.a,{title:"Book member",visible:this.state.modalVisible,onOk:this.handleOk,onCancel:this.handleCancel},this.state.isFetchingMembers?"Loading..":r.a.createElement("select",{onChange:function(t){e.setState({selectedMember:parseInt(t.target.value)})}},r.a.createElement("option",{selected:!0,disabled:!0},"Select member"),this.state.members.map((function(e){return r.a.createElement("option",{key:e.id,value:e.id},e.fullName)})))))}},{key:"componentDidMount",value:function(){this.fetchRoster(this.classId)}}]),a}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(271);c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(A,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[153,1,2]]]);
//# sourceMappingURL=main.8e9b04b9.chunk.js.map